{% extends 'base.html' %}

{% block content %}
<div style="
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: flex-start;
    min-height: 100vh;
    padding: 20px;
    box-sizing: border-box;
    width: 100%;
    overflow-x: hidden; /* Prevent horizontal scroll */
">
    <!-- Header Row with Back Button, Title, and Menu Button -->
    <div style="
        display: flex;
        align-items: center;
        justify-content: space-between;
        width: 100%;
        max-width: 100%;
        margin-bottom: 15px;
        padding: 0 10px;
        box-sizing: border-box;
        gap: 10px; /* Space between elements */
    ">
        <!-- Back Button -->
        <button onclick="window.history.back()" style="
            display: inline-flex;
            align-items: center;
            justify-content: center;
            font-size: clamp(12px, 2.5vw, 14px);
            font-weight: bold;
            color: #007bff;
            padding: 8px 12px;
            border-radius: 20px;
            background: linear-gradient(130deg, #e3f2fd, #bbdefb);
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            border: none;
            cursor: pointer;
            transition: background 0.3s ease, transform 0.2s ease;
            white-space: nowrap;
            flex-shrink: 0;
        " onmouseover="this.style.background='linear-gradient(130deg, #bbdefb, #bbdefb)'; this.style.transform='scale(1.05)'" onmouseout="this.style.background='linear-gradient(130deg, #e3f2fd, #bbdefb)'; this.style.transform='scale(1)'">
            <span style="font-size: clamp(16px, 3vw, 20px);">⬅️</span>
        </button>

        <!-- Page Title -->
        <h2 style="
            font-size: clamp(18px, 4vw, 22px); /* Scale with viewport, adjusted max */
            font-weight: bold;
            color: #007bff;
            margin: 0;
            flex-grow: 1;
            text-align: center;
            white-space: normal; /* Allow wrapping */
        ">
            ➕ Create Church Member
        </h2>

        <!-- Menu Button Partial -->
        {% include 'accounts/partials/menu_button_partial.html' %}
    </div>

    <!-- Responsive Form -->
    <form method="POST" enctype="multipart/form-data" style="
        display: flex;
        flex-direction: column;
        gap: 15px;
        align-items: center;
        width: 100%;
        padding: 0 10px;
        box-sizing: border-box;
    ">
        {% csrf_token %}
        
        <!-- Display Django messages if any -->
        {% if messages %}
            {% for message in messages %}
                <p style="color: {% if message.tags == 'success' %}green{% else %}red{% endif %}; text-align: center;">
                    {{ message }}
                </p>
            {% endfor %}
        {% endif %}

        <!-- Single Form Fields -->
        <div style="width: 100%;">
            <!-- Basic Information -->
            <div style="margin-bottom: 10px;">
                <label for="{{ form.full_name.id_for_label }}" style="font-weight: bold;">
                    {{ form.full_name.label }} *
                </label>
                {{ form.full_name }}
                {% if form.full_name.errors %}
                    <small style="color: red;">{{ form.full_name.errors|join:", " }}</small>
                {% endif %}
            </div>
            <div style="margin-bottom: 10px;">
                <label for="{{ form.date_of_birth.id_for_label }}" style="font-weight: bold;">
                    {{ form.date_of_birth.label }} *
                </label>
                {{ form.date_of_birth }}
                {% if form.date_of_birth.errors %}
                    <small style="color: red;">{{ form.date_of_birth.errors|join:", " }}</small>
                {% endif %}
            </div>
            <div style="margin-bottom: 10px;">
                <label for="{{ form.gender.id_for_label }}" style="font-weight: bold;">
                    {{ form.gender.label }} *
                </label>
                {{ form.gender }}
                {% if form.gender.errors %}
                    <small style="color: red;">{{ form.gender.errors|join:", " }}</small>
                {% endif %}
            </div>
            <div style="margin-bottom: 10px;">
                <label for="{{ form.phone_number.id_for_label }}" style="font-weight: bold;">
                    {{ form.phone_number.label }} *
                </label>
                {{ form.phone_number }}
                {% if form.phone_number.errors %}
                    <small style="color: red;">{{ form.phone_number.errors|join:", " }}</small>
                {% endif %}
            </div>
            <div style="margin-bottom: 10px;">
                <label for="{{ form.email.id_for_label }}" style="font-weight: bold;">
                    {{ form.email.label }}
                </label>
                {{ form.email }}
                {% if form.email.errors %}
                    <small style="color: red;">{{ form.email.errors|join:", " }}</small>
                {% endif %}
            </div>
            <div style="margin-bottom: 10px;">
                <label for="{{ form.address.id_for_label }}" style="font-weight: bold;">
                    {{ form.address.label }} *
                </label>
                {{ form.address }}
                {% if form.address.errors %}
                    <small style="color: red;">{{ form.address.errors|join:", " }}</small>
                {% endif %}
            </div>

            <!-- Cell and Status -->
            <div style="margin-bottom: 10px;">
                <label for="{{ form.cell.id_for_label }}" style="font-weight: bold;">
                    {{ form.cell.label }}
                </label>
                {{ form.cell }}
                {% if form.cell.errors %}
                    <small style="color: red;">{{ form.cell.errors|join:", " }}</small>
                {% endif %}
            </div>
            <div style="margin-bottom: 10px;">
                <label for="{{ form.status.id_for_label }}" style="font-weight: bold;">
                    {{ form.status.label }} *
                </label>
                {{ form.status }}
                {% if form.status.errors %}
                    <small style="color: red;">{{ form.status.errors|join:", " }}</small>
                {% endif %}
            </div>

            <!-- Baptism Fields -->
            <div style="margin-bottom: 10px;">
                <label for="{{ form.is_baptised.id_for_label }}" style="font-weight: bold;">
                    {{ form.is_baptised.label }}
                </label>
                {{ form.is_baptised }}
                {% if form.is_baptised.errors %}
                    <small style="color: red;">{{ form.is_baptised.errors|join:", " }}</small>
                {% endif %}
            </div>
            <div style="margin-bottom: 10px;">
                <label for="{{ form.date_of_baptism.id_for_label }}" style="font-weight: bold;">
                    {{ form.date_of_baptism.label }}
                </label>
                {{ form.date_of_baptism }}
                {% if form.date_of_baptism.errors %}
                    <small style="color: red;">{{ form.date_of_baptism.errors|join:", " }}</small>
                {% endif %}
            </div>
            <div style="margin-bottom: 10px;">
                <label for="{{ form.baptism_certificate.id_for_label }}" style="font-weight: bold;">
                    {{ form.baptism_certificate.label }}
                </label>
                {{ form.baptism_certificate }}
                {% if form.baptism_certificate.errors %}
                    <small style="color: red;">{{ form.baptism_certificate.errors|join:", " }}</small>
                {% endif %}
            </div>

            <!-- Confirmation Fields -->
            <div style="margin-bottom: 10px;">
                <label for="{{ form.is_confirmed.id_for_label }}" style="font-weight: bold;">
                    {{ form.is_confirmed.label }}
                </label>
                {{ form.is_confirmed }}
                {% if form.is_confirmed.errors %}
                    <small style="color: red;">{{ form.is_confirmed.errors|join:", " }}</small>
                {% endif %}
            </div>
            <div style="margin-bottom: 10px;">
                <label for="{{ form.date_confirmed.id_for_label }}" style="font-weight: bold;">
                    {{ form.date_confirmed.label }}
                </label>
                {{ form.date_confirmed }}
                {% if form.date_confirmed.errors %}
                    <small style="color: red;">{{ form.date_confirmed.errors|join:", " }}</small>
                {% endif %}
            </div>
            <div style="margin-bottom: 10px;">
                <label for="{{ form.confirmation_certificate.id_for_label }}" style="font-weight: bold;">
                    {{ form.confirmation_certificate.label }}
                </label>
                {{ form.confirmation_certificate }}
                {% if form.confirmation_certificate.errors %}
                    <small style="color: red;">{{ form.confirmation_certificate.errors|join:", " }}</small>
                {% endif %}
            </div>

            <!-- Marital Status -->
            <div style="margin-bottom: 10px;">
                <label for="{{ form.marital_status.id_for_label }}" style="font-weight: bold;">
                    {{ form.marital_status.label }} *
                </label>
                {{ form.marital_status }}
                {% if form.marital_status.errors %}
                    <small style="color: red;">{{ form.marital_status.errors|join:", " }}</small>
                {% endif %}
            </div>
            <div style="margin-bottom: 10px;">
                <label for="{{ form.date_of_marriage.id_for_label }}" style="font-weight: bold;">
                    {{ form.date_of_marriage.label }}
                </label>
                {{ form.date_of_marriage }}
                {% if form.date_of_marriage.errors %}
                    <small style="color: red;">{{ form.date_of_marriage.errors|join:", " }}</small>
                {% endif %}
            </div>

            <!-- Emergency Contact -->
            <div style="margin-bottom: 10px;">
                <label for="{{ form.emergency_contact_name.id_for_label }}" style="font-weight: bold;">
                    {{ form.emergency_contact_name.label }} *
                </label>
                {{ form.emergency_contact_name }}
                {% if form.emergency_contact_name.errors %}
                    <small style="color: red;">{{ form.emergency_contact_name.errors|join:", " }}</small>
                {% endif %}
            </div>
            <div style="margin-bottom: 10px;">
                <label for="{{ form.emergency_contact_phone.id_for_label }}" style="font-weight: bold;">
                    {{ form.emergency_contact_phone.label }} *
                </label>
                {{ form.emergency_contact_phone }}
                {% if form.emergency_contact_phone.errors %}
                    <small style="color: red;">{{ form.emergency_contact_phone.errors|join:", " }}</small>
                {% endif %}
            </div>

            <!-- Leadership Status (Last Field) -->
            <div style="margin-bottom: 10px;">
                <label for="{{ form.is_this_church_member_a_leader.id_for_label }}" style="font-weight: bold;">
                    {{ form.is_this_church_member_a_leader.label }}
                </label>
                {{ form.is_this_church_member_a_leader }}
                {% if form.is_this_church_member_a_leader.errors %}
                    <small style="color: red;">{{ form.is_this_church_member_a_leader.errors|join:", " }}</small>
                {% endif %}
            </div>
        </div>

        <!-- Submit Button -->
        <button
            type="submit"
            style="
                width: 100%;
                max-width: 100%;
                background: #007bff;
                color: white;
                padding: 12px;
                border: none;
                border-radius: 8px;
                font-size: 16px;
                cursor: pointer;
            "
        >
            ✅ Save Church Member
        </button>
    </form>

    <!-- Cancel Link -->
    <a href="{% url 'church_member_list' %}"
       style="
           display: block;
           margin-top: 15px;
           text-align: center;
           color: #dc3545;
           font-weight: bold;
           text-decoration: none;
           width: 100%;
       "
    >
        ❌ Cancel
    </a>
</div>

<!-- Inline Styles -->
<style>
    input, select, textarea {
        width: 100%;
        max-width: 100%;
        padding: 12px;
        font-size: 16px;
        border-radius: 8px;
        border: 1px solid #ccc;
        box-sizing: border-box;
    }
    input:focus, select:focus, textarea:focus {
        border-color: #007bff;
        box-shadow: 0 0 8px rgba(0, 123, 255, 0.2);
    }

    @media only screen and (max-width: 768px) {
        form {
            width: 100%;
            padding: 0 10px;
        }
        input, select, textarea {
            width: 100%;
            max-width: 100%;
        }
    }
</style>
{% endblock %}