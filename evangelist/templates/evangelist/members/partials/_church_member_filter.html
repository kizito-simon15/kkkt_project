<!-- Filter Section -->
<div class="filter-form">
    <!-- Name Filter -->
    <input type="text" id="searchName" placeholder="üîç Search by Name">

    <!-- Gender Filter -->
    <select id="genderFilter">
        <option value="all">‚ö• Filter by Gender</option>
        <option value="Male">Male</option>
        <option value="Female">Female</option>
    </select>

    <!-- Cell Filter -->
    <select id="cellFilter">
        <option value="all">üè° Filter by Cell</option>
        {% for cell in cells %}
            <option value="{{ cell.cell_id }}">{{ cell.name }}</option>
        {% endfor %}
    </select>

    <!-- OutStation Filter -->
    <select id="outstationFilter">
        <option value="all">üìç Filter by OutStation</option>
        {% for outstation in outstations %}
            <option value="{{ outstation.outstation_id }}">{{ outstation.name }}</option>
        {% endfor %}
    </select>
</div>

<!-- JavaScript for Real-Time Filtering -->
<script>
    function filterChurchMembers() {
        let nameFilter = document.getElementById("searchName").value.toLowerCase();
        let genderFilter = document.getElementById("genderFilter").value;
        let cellFilter = document.getElementById("cellFilter").value;
        let outstationFilter = document.getElementById("outstationFilter").value;

        let members = document.querySelectorAll(".church-member-row");

        let totalMales = 0;
        let totalFemales = 0;
        let totalMembers = 0;

        members.forEach(member => {
            let name = member.getAttribute("data-name").toLowerCase();
            let gender = member.getAttribute("data-gender");
            let cell = member.getAttribute("data-cell");
            let outstation = member.getAttribute("data-outstation");

            let showByName = name.includes(nameFilter);
            let showByGender = (genderFilter === "all" || gender === genderFilter);
            let showByCell = (cellFilter === "all" || cell === cellFilter);
            let showByOutstation = (outstationFilter === "all" || outstation === outstationFilter);

            if (showByName && showByGender && showByCell && showByOutstation) {
                member.style.display = "table-row";
                totalMembers++;

                if (gender === "Male") {
                    totalMales++;
                } else if (gender === "Female") {
                    totalFemales++;
                }
            } else {
                member.style.display = "none";
            }
        });

        // Update the summary section
        document.getElementById("totalMales").textContent = totalMales;
        document.getElementById("totalFemales").textContent = totalFemales;
        document.getElementById("totalMembers").textContent = totalMembers;
    }

    // Attach event listeners for real-time filtering
    document.getElementById("searchName").addEventListener("input", filterChurchMembers);
    document.getElementById("genderFilter").addEventListener("change", filterChurchMembers);
    document.getElementById("cellFilter").addEventListener("change", filterChurchMembers);
    document.getElementById("outstationFilter").addEventListener("change", filterChurchMembers);

    // Trigger initial filter to apply any pre-selected filters from URL
    filterChurchMembers();
</script>

<!-- CSS for Styling -->
<style>
    /* üåü Centered Filter Section */
    .filter-form {
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 12px;
        width: 100%;
        max-width: 600px;
        margin: 20px auto;
        padding: 10px;
    }

    /* üîç Input Fields */
    .filter-form input,
    .filter-form select {
        width: 100%;
        max-width: 400px;
        padding: 12px;
        border: 1px solid #ccc;
        border-radius: 25px;
        font-size: 16px;
        outline: none;
        text-align: center;
        box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
        transition: all 0.2s ease-in-out;
    }

    /* üé® Input Focus Effect */
    .filter-form input:focus,
    .filter-form select:focus {
        border-color: #007bff;
        box-shadow: 0 2px 8px rgba(0, 123, 255, 0.3);
    }

    /* üì± Mobile Responsiveness */
    @media (max-width: 768px) {
        .filter-form input,
        .filter-form select {
            font-size: 14px;
            padding: 10px;
        }
    }
</style>