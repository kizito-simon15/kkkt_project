{% load static %}

<!-- Bride Selection -->
<h3>üë© Select Bride</h3>

<!-- Search Field -->
<input type="text" id="searchFemale" placeholder="üîç Search by Name..."
       style="width: 90%; max-width: 500px; padding: 10px; border: 1px solid #ccc; 
              border-radius: 25px; font-size: 16px; outline: none; 
              box-shadow: inset 0 2px 5px rgba(0,0,0,0.1); margin-bottom: 15px; display: block; margin-left: auto; margin-right: auto;">

<ul id="femaleList" style="list-style: none; padding: 0;">
    {% for female in females %}
    <li class="female-item" data-name="{{ female.full_name|lower }}" data-id="{{ female.id }}"
        style="display: flex; align-items: center; justify-content: space-between; padding: 10px; border-bottom: 1px solid #ddd;">
        
        <label style="display: flex; align-items: center; gap: 8px; flex-grow: 1;">
            <input type="checkbox" name="selected_female" value="{{ female.id }}" class="female-checkbox"
                   onclick="toggleFemales(this)">
        
            <!-- Handle missing passport image -->
            <img src="{% if female.passport %}{{ female.passport.url }}{% else %}{% static 'images/user.png' %}{% endif %}" 
                 alt="Member Passport"
                 style="width: 40px; height: 40px; border-radius: 50%;">
        
            <span style="display: flex; flex-direction: column;">
                <span style="font-weight: bold;">
                    {{ female.full_name }}
                    <small style="color: #ff69b4;">‚ôÄ(F)</small> <!-- Female Symbol -->
                </span>
                <small style="color: gray;">
                    ({{ female.date_of_birth|date:"Y" }} - Age: {{ female.date_of_birth|timesince }} years)
                </small>
                {% if female.community %}
                    <small style="color: blue;">
                        ({{ female.cell.name }} - {{ female.cell.outstation.name }})
                    </small>
                {% else %}
                    <small style="color: red;">(No Community)</small>
                {% endif %}
            </span>
        </label>

        <!-- WhatsApp-like Green Tick for Active Members -->
        {% if female.status == "Active" %}
            <span class="active-tick" style="color: #25D366; font-size: 14px; margin-left: 5px; flex-shrink: 0;" title="Active Member">‚úîÔ∏è</span>
        {% endif %}
    </li>
    {% endfor %}
</ul>

<script>
    function filterFemales() {
        let searchQuery = document.getElementById("searchFemale").value.toLowerCase();
        let females = document.querySelectorAll(".female-item");

        females.forEach(female => {
            let name = female.getAttribute("data-name");
            if (name.includes(searchQuery)) {
                female.style.display = "flex";
            } else {
                female.style.display = "none";
            }
        });
    }

    function toggleFemales(selectedCheckbox) {
        let females = document.querySelectorAll(".female-item");

        females.forEach(female => {
            let checkboxInside = female.querySelector(".female-checkbox");
            let tickInside = female.querySelector(".active-tick");

            if (selectedCheckbox.checked) {
                // Hide all unchecked females along with their ticks
                if (checkboxInside !== selectedCheckbox) {
                    female.style.display = "none";
                    if (tickInside) tickInside.style.display = "none"; // Hide tick
                }
            } else {
                // Show all females and their ticks when unchecked
                female.style.display = "flex";
                if (tickInside) tickInside.style.display = "inline"; // Show tick again
            }
        });
    }

    // Attach event listener to filter field
    document.getElementById("searchFemale").addEventListener("input", filterFemales);
</script>
