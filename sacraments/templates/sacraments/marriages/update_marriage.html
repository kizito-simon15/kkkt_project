{% extends 'base.html' %}
{% load static %}

{% block content %}

<!-- Navigation Icons (Centered & Minimalist) -->
<!-- Removed original navigation div since back button is now in header row -->
<!-- <div style="display: flex; justify-content: center; gap: 15px; margin: 20px;">
    <a href="{% url 'marriage_list' %}" title="Back to Marriage List"
       style="display: flex; align-items: center; justify-content: center; 
              width: 35px; height: 35px; color: black; 
              border-radius: 50%; text-decoration: none; font-size: 20px;">
        â¬…ï¸
    </a>
</div> -->

<div style="text-align: center; margin: 10px;">
    <!-- Header Row with Back Button, Title, and Menu Button -->
    <div style="
        display: flex;
        align-items: center;
        justify-content: space-between;
        width: 100%;
        max-width: 100vw;
        padding: 0 10px;
        box-sizing: border-box;
        gap: 10px;
        margin-bottom: 20px;
    ">
        <!-- Back Button -->
        <button onclick="window.history.back()" style="
            display: inline-flex;
            align-items: center;
            justify-content: center;
            font-size: clamp(12px, 2.5vw, 14px);
            font-weight: bold;
            color: #007bff;
            padding: 8px 12px;
            border-radius: 20px;
            background: linear-gradient(130deg, #e3f2fd, #bbdefb);
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            border: none;
            cursor: pointer;
            transition: background 0.3s ease, transform 0.2s ease;
            white-space: nowrap;
            flex-shrink: 0;
        " onmouseover="this.style.background='linear-gradient(130deg, #bbdefb, #bbdefb)'; this.style.transform='scale(1.05)'" 
          onmouseout="this.style.background='linear-gradient(130deg, #e3f2fd, #bbdefb)'; this.style.transform='scale(1)'">
            <span style="font-size: clamp(16px, 3vw, 20px);">â¬…ï¸</span>
        </button>

        <!-- Page Header -->
        <h2 style="
            font-size: clamp(18px, 4vw, 18px);
            font-weight: bold;
            color: #333;
            margin: 0;
            text-align: center;
            flex-grow: 1;
            white-space: normal;
        ">
            âœï¸ Update Marriage
        </h2>

        <!-- Menu Button Partial -->
        {% include 'accounts/partials/menu_button_partial.html' %}
    </div>

    <p style="font-size: 16px; font-weight: bold;">{{ member.full_name }}</p>
</div>

<!-- Success/Error Messages -->
{% if messages %}
    <div style="text-align: center; margin-bottom: 10px;">
        {% for message in messages %}
            <p style="color: {% if message.tags == 'error' %}red{% else %}green{% endif %}; font-size: 14px;">
                {{ message }}
            </p>
        {% endfor %}
    </div>
{% endif %}

<form method="POST" enctype="multipart/form-data" style="max-width: 90%; margin: auto;">
    {% csrf_token %}

    <!-- Date of Marriage -->
    <div style="margin-bottom: 15px;">
        <label for="marriageDate" style="font-size: 14px; font-weight: bold;">ğŸ“… Date of Marriage:</label>
        <input type="date" id="marriageDate" name="marriage_date" required value="{{ member.date_of_marriage|date:'Y-m-d' }}"
               style="width: 100%; padding: 8px; border: none; border-bottom: 1px solid black; font-size: 14px; text-align: center; outline: none;">
    </div>

    <!-- Spouse Name -->
    <div style="margin-bottom: 15px;">
        <label for="spouseName" style="font-size: 14px; font-weight: bold;">ğŸ’ Spouse Name:</label>
        <input type="text" id="spouseName" name="spouse_name" required value="{{ member.spouse_name }}"
               style="width: 100%; padding: 8px; border: none; border-bottom: 1px solid black; font-size: 14px; text-align: center; outline: none;">
    </div>

    <!-- Current Marriage Certificate -->
    {% if member.marriage_certificate %}
        <div style="margin-bottom: 15px; text-align: center;">
            <label style="font-size: 14px; font-weight: bold;">ğŸ“œ Current Marriage Certificate:</label>
            <div style="display: flex; justify-content: center; gap: 10px;">
                <a href="{{ member.marriage_certificate.url }}" target="_blank" 
                   title="View Marriage Certificate" 
                   style="font-size: 14px; color: black; text-decoration: none;">
                    ğŸ“œ View
                </a>
                <a href="{{ member.marriage_certificate.url }}" download
                   title="Download Marriage Certificate" 
                   style="font-size: 14px; color: black; text-decoration: none;">
                    â¬‡ï¸ Download
                </a>
            </div>
            <!-- Remove Certificate Checkbox -->
            <div style="margin-top: 10px;">
                <input type="checkbox" id="removeCertificate" name="remove_certificate">
                <label for="removeCertificate" style="font-size: 12px;">Remove Current Certificate</label>
            </div>
        </div>
    {% else %}
        <p style="text-align: center; color: red; font-size: 12px;">âš ï¸ No Marriage Certificate Available</p>
    {% endif %}

    <!-- Upload New Marriage Certificate -->
    <div style="margin-bottom: 15px;">
        <label for="marriageCertificate" style="font-size: 14px; font-weight: bold;">ğŸ“œ Upload New Marriage Certificate:</label>
        <input type="file" id="marriageCertificate" name="marriage_certificate"
               style="width: 100%; padding: 8px; border: none; font-size: 14px; text-align: center;">
    </div>

    <!-- Save Button -->
    <div style="text-align: center; margin-top: 15px;">
        <button type="submit"
                style="padding: 8px; width: 35px; height: 35px; background: black; 
                       color: white; border: none; border-radius: 50%; cursor: pointer; 
                       font-size: 14px;" 
                title="Save Changes">
            âœ…
        </button>
    </div>
</form>

{% endblock %}