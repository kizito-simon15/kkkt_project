{% load static %}

<!-- Sidebar -->
<div class="sidebar" id="sidebar" style="
    position: fixed;
    /* Offset the sidebar below any top bar or translator widget. 
       E.g., if your topbar is ~60px high, you can set top: 60px.
       If you prefer no offset, set top: 0; but ensure the close icon is visible. */
    top: 60px; 
    left: -200px; /* Hidden initially */
    width: 200px;
    /* Make the sidebar fit the viewport minus the offset: */
    max-height: calc(100vh - 60px); 
    overflow: auto;       /* Allow vertical scrolling if content is taller */
    z-index: 2000;        /* Above other elements, so the sidebar is visible */
    display: none;        /* Hidden until toggled */
    flex-direction: column;
    align-items: center;
    background-color: var(--sidebar-background);
    animation: none;      /* Applied dynamically via JS */
    transition: left 0.3s ease, display 0.3s ease;
">

    <!-- Close Icon (‚ùå) -->
    <div id="closeSidebar" style="
        position: absolute;
        top: 8px;  /* Slightly smaller offset inside the sidebar */
        right: 8px;
        font-size: 18px;  /* Smaller close icon */
        cursor: pointer;
        color: #fff; /* White text/icon color */
        background-color: blue; /* Red background */
        width: 32px;               /* Slightly smaller dimension */
        height: 32px;
        display: flex;
        align-items: center;
        justify-content: center;
        border-radius: 50%;
        box-shadow: 0px 3px 6px rgba(0, 0, 0, 0.3);
        z-index: 2001;   /* Even higher than the sidebar container */
        overflow: hidden;
        transition: transform 0.3s ease, background-color 0.3s ease;
    " 
    onmouseover="this.style.backgroundColor='blue'" 
    onmouseout="this.style.backgroundColor='blue'">
        ‚ùå
    </div>

    <!-- User Profile Picture -->
    <a href="{% url 'evangelist_upload_profile_picture' %}" style="text-decoration: none;">
        {% if user.profile_picture %}
            <img
                src="{{ user.profile_picture.url }}"
                alt="User Profile Picture"
                style="
                    width: 40px;  /* Slightly smaller user pic */
                    height: 40px;
                    border-radius: 50%;
                    object-fit: cover;
                    border: 2px solid var(--sidebar-icon-border);
                    box-shadow: 0px 3px 6px rgba(0,0,0,0.2);
                    margin-top: 40px;  /* Leaves space for close button at top */
                    margin-bottom: 15px; 
                "
            />
        {% else %}
            <img
                src="{% static 'images/user.png' %}"
                alt="Default User Icon"
                style="
                    width: 40px;
                    height: 40px;
                    border-radius: 50%;
                    object-fit: cover;
                    border: 2px solid var(--sidebar-icon-border);
                    box-shadow: 0px 3px 6px rgba(0,0,0,0.2);
                    margin-top: 40px;
                    margin-bottom: 15px;
                "
            />
        {% endif %}
    </a>

    <!-- Reusable .sidebar-button style -->
    <style>
        .sidebar-button {
            display: flex;
            align-items: center;
            justify-content: flex-start;
            /* Slightly smaller spacing & sizing for phones */
            gap: 6px;       
            width: 80%;
            padding: 6px 10px; 
            margin-bottom: 8px;
            font-size: 12px;   /* Smaller text for phone screens */
            text-decoration: none;
            color: white;
            border-radius: 12px;
            box-shadow: 0px 3px 6px rgba(0, 0, 0, 0.2);
            transition: background-color 0.3s ease, transform 0.3s ease;
        }

        .sidebar-button:hover {
            transform: scale(1.03);
        }
    </style>

    <!-- Example Buttons with Emojis -->
    <!-- Home Button (üè†) -->
    <a href="{% url 'evangelist_dashboard' %}" class="sidebar-button" style="background-color: #007bff;"
       onmouseover="this.style.backgroundColor='#0056b3'"
       onmouseout="this.style.backgroundColor='#007bff'">
        <span style="font-size: 16px;">üè†</span>
        <span>Home</span>
    </a>

    <!-- Details Button (‚ÑπÔ∏è) -->
    <a href="{% url 'evangelist_details' %}" class="sidebar-button" style="background-color: #28a745;"
       onmouseover="this.style.backgroundColor='#1c7430'"
       onmouseout="this.style.backgroundColor='#28a745'">
        <span style="font-size: 16px;">‚ÑπÔ∏è</span>
        <span>Details</span>
    </a>

    <!-- Leaders Button (üë•) -->
    <a href="{% url 'evangelist_leaders_home' %}" class="sidebar-button" style="background-color: #ffc107;"
       onmouseover="this.style.backgroundColor='#e0a800'"
       onmouseout="this.style.backgroundColor='#ffc107'">
        <span style="font-size: 16px;">üë•</span>
        <span>Leaders</span>
    </a>

    <!-- Members (üßç) -->
    <a href="{% url 'evangelist_members_home' %}" class="sidebar-button" style="background-color: #fd7e14;"
       onmouseover="this.style.backgroundColor='#e86800'"
       onmouseout="this.style.backgroundColor='#fd7e14'">
        <span style="font-size: 16px;">üßç</span>
        <span>Members</span>
    </a>

    <!-- News (üì∞) -->
    <a href="{% url 'evangelist_news_home' %}" class="sidebar-button" style="background-color: #17a2b8;"
       onmouseover="this.style.backgroundColor='#117a8b'"
       onmouseout="this.style.backgroundColor='#17a2b8'">
        <span style="font-size: 16px;">üì∞</span>
        <span>News</span>
    </a>

    <!-- Notifications (üîî) -->
    <a href="{% url 'evangelist_notifications' %}" class="sidebar-button" style="background-color: #6f42c1;"
       onmouseover="this.style.backgroundColor='#59369e'"
       onmouseout="this.style.backgroundColor='#6f42c1'">
        <span style="font-size: 16px;">üîî</span>
        <span>Notifications</span>
    </a>

    <!-- Offerings Button (üí∞) -->
    <a href="#" class="sidebar-button" style="background-color: #dc3545;"
       onmouseover="this.style.backgroundColor='#b02a37'"
       onmouseout="this.style.backgroundColor='#dc3545'">
        <span style="font-size: 16px;">üí∞</span>
        <span>Offerings</span>
    </a>

</div>

<script>
    const sidebar = document.getElementById('sidebar');
    const sidebarToggle = document.getElementById('sidebarToggle');
    const closeSidebar = document.getElementById('closeSidebar');
    let sidebarVisible = false;

    const toggleSidebar = () => {
        sidebarVisible = !sidebarVisible;
        if (sidebarVisible) {
            // Show sidebar
            sidebar.style.display = 'flex';
            sidebar.style.animation = 'slideIn 0.5s ease forwards';
            setTimeout(() => {
                sidebar.style.left = '0';
            }, 10);
        } else {
            // Hide sidebar
            sidebar.style.left = '-200px';
            sidebar.style.animation = 'slideOut 0.5s ease forwards';
            setTimeout(() => {
                sidebar.style.display = 'none';
            }, 300);
        }
    };

    sidebarToggle.addEventListener('click', toggleSidebar);
    closeSidebar.addEventListener('click', toggleSidebar);

    // Keyframe animations
    const style = document.createElement('style');
    style.innerHTML = `
        @keyframes slideIn {
            from { left: -200px; opacity: 0; }
            to { left: 0; opacity: 1; }
        }
        @keyframes slideOut {
            from { left: 0; opacity: 1; }
            to { left: -200px; opacity: 0; }
        }
    `;
    document.head.appendChild(style);
</script>